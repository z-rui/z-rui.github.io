---
date: 2015-06-22T18:20:00+08:00
title: "抛硬币问题的另解"
---

周四将要进行《概率论与数理统计》的期末考试。为了表示纪念，研究一个和概率论相关的问题。

> 连续抛掷一枚硬币，直到出现连续的两个正面为止。问：抛掷次数的数学期望是多少？

<!--more-->

假设抛掷了\\(n\\)枚硬币后，出现了连续的两个正面，抛掷过程终止。那么，把这\\(n\\)次的抛掷结果排列成一排，那么：

1. 前\\(n-2\\)枚硬币构成的序列中，一定不存在连续的两个正面，并且第\\(n-2\\)枚硬币是反面；
2. 最后两枚硬币都是正面。

把长度为\\(k\\)的、不存在连续两个正面、且最后一枚硬币是反面的序列称为\\(F\_k\\)序列。那么，对于一个特定的\\(k\\)，\\(F\_k\\)序列有多少种？（把这个数值也记作\\(F\_k\\)。）这属于组合数学的问题，可以做如下考虑：

怎样构造一个\\(F\_k\\)序列？有两种办法：

1. 找到一个\\(F\_{k-1}\\)序列，在末尾增加一个反面；
2. 找到一个\\(F\_{k-2}\\)序列，在末尾增加一个正面、一个反面。

不难看出，用上边两种办法，就可以不重、不漏地生成所有的\\(F\_k\\)序列。根据分类计数原理，就可以得到一个递推公式
\\[F\_k=F\_{k-1}+F\_{k-2}.\\]
边界条件是\\(F\_1=1,\,F\_2=2\\)。把数列逐项写出来是
\\[1,2,3,5,8,\dots\\]

设随机变量\\(X\\)=“停止抛掷时已经抛掷硬币的次数”，则其分布律为
\\[P\\{X=k\\}={{F\_{k-2}} \over 2^k}, \qquad k=2,3,4,\dots\\]

式中，当\\(k=2\\)时，约定\\(F\_0=1\\)。

数学期望
\\[\mu=\sum\_{k=2}^\infty k{F\_{k-2} \over 2^k}.\\]

这个问题的重要部分就是怎样对这个级数求和。[使用生成函数][matrix67]不失为一种巧妙的做法，但是需要微积分的知识，运算稍显繁琐。

利用概率的**归一性**，可以让求解稍微简单些。归一性指的是\\(X\\)取所有可能取值的概率之和等于1：
\\[\sum\_{k=2}^\infty P\\{X=k\\} = \sum\_{k=2}^\infty {F\_{k-2} \over 2^k}=1.\\]

在概率论的语境下，这是显然的。但如果我们不知道这个求和式的概率论背景，那么也没法轻松地得出和等于1的结果。所以归一性在这里提供了隐含条件。

把归一性公式和数学期望的公式写成展开的形式
\\[\eqalign{
\mu &= 2\times&{F\_0\over2^2} + 3\times&{F\_1\over2^3} + 4\times&{F\_2\over2^4} + \cdots \cr
1 &= &{F\_0\over2^2} + &{F\_1\over2^3} + &{F\_2\over2^4} + \cdots \cr
}\\]

两式相加得
\\[\mu+1 = 3\times{F\_0\over2^2} + 4\times{F\_1\over2^3} + 5\times{F\_2\over2^4} + \cdots\\]

应用错位相减法，并且利用\\(F\_k\\)的递推公式，可得
\\[\eqalign{
\mu &= &2\times{F\_0\over2^2} + &3\times{F\_1\over2^3} + &4\times{F\_2\over2^4} + &5\times{F\_3\over2^5} + \cdots \cr
{\mu+1\over2} &= &&3\times{F\_0\over2^3} + &4\times{F\_1\over2^4} + &5\times{F\_2\over2^5} + \cdots}\\]
两式相减得\\[\eqalign{
{\mu-1\over2} &= 2\times{F\_0\over2^2} + 4\times{F\_0\over2^4} + 5\times{F\_1\over2^5} + \cdots \cr
&={1\over2} + {1\over4}\left[\left(2\times{F\_0\over2^2}+3\times{F\_1\over2^3}+\cdots\right)+2\left({F\_0\over2^2}+{F\_1\over2^3}+\cdots\right)\right] \cr
&={1\over2} + {\mu+2\over4}
}\\]

由最后一个式子解得\\(\mu=6\\)。

## 后记

1. 这个做法不是最简单的。
2. 文章最后部分的5个等号，如果全部对齐，显示效果应该会更好。但是我不知道怎么把它们对齐。\\(\rm \TeX book\\)还应该多读一读。

[matrix67]: http://www.matrix67.com/blog/archives/4534
