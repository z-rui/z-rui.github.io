---
title: 高等算术习题(5) -- 平方和
date: 2022-03-07T23:37:13-08:00
---

《高等算术》第五章研究将自然数表示为平方和的方法，讨论了三种情况：
* 二平方和：所有形如 4k+3 的质因子的次数必须为偶数（可以是 0）；
* 四平方和：任意自然数都可以表示为四平方和；
* 三平方和：除了形如 4<sup>l</sup>(8k+7) 外的自然数都可以表示为三平方和（未给出证明）。

对于二平方和问题，书中给出了若干构造方法。

<!--more-->

---

**5.1** 以下哪些数可以表示为二平方和：97, 221, 300, 490, 729, 1001。

**解**

* 97 是质数且等于 4&times;24+1，因此可以表示为二平方和。
* 221 = 13&times;17，每个质因子都是 4k+1 的形式，因此可以表示为而平方和。
* 300 = 2&times;3&times;5²，质因子 3 不满足要求。
* 490 = 2&times;5&times;7²，可以表示为二平方和。
* 729 = 3⁶，可以表示为二平方和。
* 1001 = 7&times;11&times;13，质因子 7 和 13 都不满足要求。

---

**5.2** 验证恒等式
\\[(a^2+b^2)(c^2+d^2)=(ac+bd)^2+(ad-bc)^2=(ac-bd)^2+(ad+bc)^2\\]
并由此可知，一般地，这样的乘积有两种表示法。这里“一般地”是什么意思？

**证明** 直接展开即可证明。或者，也可以考虑用复数的运算法则来证明。设 \\(\alpha=a+b\mkern1mui\\) 且 \\(\beta=c+d\mkern1mui\\)，那么要证的等式等价于
\\[|\alpha|^2|\beta|^2 = |\alpha\beta|^2 = |\alpha\bar\beta|^2\\]
根据复数的运算法则可知这个等式恒成立。

这里“一般地”指在个别情况下这两种表示法可能是相同的（例如，当 \\(b=0\\) 时），但其他情况下是两种不同的表示法。

---

**5.8** 给出 103 的若干四平方和表示法。

**解**
\begin{align\*}
103 &= 1^2+1^2+1^2+10^2 \\\\
    &= 1^2+2^2+7^2+7^2 \\\\
    &= 2^2+3^2+3^2+9^2
\end{align\*}

---

**5.10** 以下哪些数能表示为三平方和：607, 307, 284, 568, 1136。

**解**

* 607 = 8&times;75+7，不能表示为三平方和。
* 307 = 8&times;38+3，可以表示为三平方和。
* 284 = 4&times;71，而 71=8&times;8+7，因此 284 不能表示为三平方和。
* 568 = 2&times;4&times;71，可以表示为三平方和。
* 1136 = 4²&times;71，不能表示为三平方和。

---

**5.11** 证明小于 \\(2^{2k+1}\\) 的自然数中，不能表示为三个自然数的平方和的个数是 \\((2^{2k}-1)/3\\)。

**解** 根据三平方和判定方法，不能表示为三平方和的数一定是 \\(4^l(8m+7)\\) 的形式。易知当 \\(l\\) 取不同的值时，得到的数一定是不同的，因此可以根据 \\(l\\) 的取值分类讨论。当固定 \\(l\\) 时，根据范围限制条件有
\\[4^l(8m+7) < 2^{2k+1}\\]
即
\\[m < 2^{2k-2-2l} - \frac78\\]
由此可知 \\(m\\) 的取值范围是
\\[0,1,2,\ldots, 2^{2k-2-2l}-1\\]
共计 \\(2^{2k-2-2l}\\) 个数，它们不能表示为三平方和。

当 \\(l=0,1,2,\ldots,k-1\\) 时，小于 \\(2^{2k+1}\\) 且不能表示为三平方和的数个数分别是
\\[2^{2k-2}, 2^{2k-4}, \ldots, 4, 1\\]
倒过来看，是首项为 \\(1\\)，公比为 \\(4\\)，共 \\(k\\) 项的等比数列。因此根据等比数列求和公式可知总数为
\\[\frac{1-4^k}{1-4} = \frac{2^{2k}-1}{3}\\]
这就是所要证明的。
